
// read vehicles
int read_vehicles(string name, Vehicle vehicles[], int max)
{
    ifstream file(name);
    string line;
    int count = 0;

    getline(file, line);

    while (getline(file, line) && count < max)
    {
        stringstream ss(line);
        string id, start, end;

        getline(ss, id, ',');
        getline(ss, start, ',');
        getline(ss, end);

        vehicles[count].add_vehicle(id, start[0], end[0]);
        count++;
    }
    file.close();
    return count;
}

int read_trafic_signals(string name, Trafic_signal signals[], int max)
{
    ifstream file(name);
    string line;
    int count = 0;

    getline(file, line);
    while (getline(file, line) && count < max)
    {
        stringstream ss(line);
        string node, time;

        getline(ss, node, ',');
        getline(ss, time);

        char n = node[0];
        int t = stoi(time);

        signals[count].add_signal(n, t);
        count++;
    }
    file.close();
    return count;
}

int read_emergency_vehicles(string name, EmergencyVehicle emergencyVehicles[], int max)
{
    ifstream file(name);
    string line;
    int count = 0;

    getline(file, line); // Skip header

    while (getline(file, line) && count < max)
    {
        stringstream ss(line);
        string id, start, end, priority;

        getline(ss, id, ',');
        getline(ss, start, ',');
        getline(ss, end, ',');
        getline(ss, priority);

        emergencyVehicles[count].add_emergency_vehicle(id, start[0], end[0], priority);
        count++;
    }
    file.close();
    return count;
}

void read_road_closures(string filename, Graph &g)
{
    ifstream file(filename);
    string line;

    getline(file, line);
    while (getline(file, line))
    {
        stringstream ss(line);
        string a, b, status;

        getline(ss, a, ',');
        getline(ss, b, ',');
        getline(ss, status);

        char start = a[0];
        char end = b[0];

        Node *temp = g.array[start - 'A'];
        bool check = false;
        // here we updated the road or edge status
        while (temp)
        {
            if (temp->vertx == end)
            {
                temp->status = status;
                check = true;
                break;
            }
            temp = temp->next;
        }
        // if not found in forward then check in reverse

        if (!check)
        {
            temp = g.array[end - 'A'];
            while (temp)
            {
                if (temp->vertx == start)
                {
                    temp->status = status;

                    break;
                }
                temp = temp->next;
            }
        }
    }
    file.close();
}
